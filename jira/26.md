---
Generated: 2025-01-27 20:30:00
Ticket Number: 26
---

# Improve product selection in add activity form with cascading dropdowns (Type → Model → Coloris)

-   Type: Feature
-   Priority: Medium
-   Story Points: 8
-   Labels: ui, forms, products, activity, user-experience
-   Git Branch: feat/fbc-26-cascading-product-selection

## Description

Replace the single "Product" select dropdown in the add activity form with three cascading dropdowns to improve user experience and make product selection more intuitive. The new flow will be: Product Type → Product Model/Name → Coloris. If only one coloris is available for the selected model, it should be automatically selected.

**Current state:**
-   Add activity form has a single "Product" select that displays all products: `"Charlie - Rose pâle à motifs (POCHETTE_VOLANTS)"`
-   Product selection is difficult when there are many products with similar names
-   No filtering or grouping by product type or model

**Business requirement:**
-   Users need to select products more easily by first choosing the product type
-   Then selecting the model/name (filtered by type)
-   Finally selecting the coloris (filtered by type + name)
-   If only one coloris is available, it should be auto-selected for better UX
-   Each product is uniquely identified by the combination: type + name + coloris

**Product data structure:**
-   `name`: Model name only (e.g., "Charlie", "Assumée", "Espiègle")
-   `type`: Product type (e.g., POCHETTE_VOLANTS, SAC_BANANE, TROUSSE_TOILETTE)
-   `coloris`: Color variation (e.g., "Rose pâle à motifs", "Rose marsala", "Prune")
-   Each combination (type + name + coloris) is a unique product with its own `id` and `stock`

**Example flow:**
1.  User selects Type: "POCHETTE_VOLANTS"
2.  System shows only models for this type: "Charlie"
3.  User selects Model: "Charlie"
4.  System shows only coloris for this type + model: "Rose pâle à motifs", "Rose marsala"
5.  If only one coloris exists, it's auto-selected
6.  Final selection: Product with `id` matching (type=POCHETTE_VOLANTS, name=Charlie, coloris=selected)

## User Story

**As a** user creating an activity  
**I want** to select products using cascading dropdowns (Type → Model → Coloris)  
**So that** I can quickly find and select the exact product I need without scrolling through a long list

## Acceptance Criteria

See individual sub-tickets for detailed acceptance criteria:

-   **Ticket #27**: Core layer filtering usecases
-   **Ticket #28**: Infrastructure layer repository methods (optional optimization)
-   **Ticket #29**: UI layer cascading selects implementation

## Sub-Tickets

**⚠️ This ticket has been split into smaller, more digestible tickets following Clean Architecture layers:**

-   **Ticket #27**: Add product filtering usecases (Core layer - Usecases)
-   **Ticket #28**: Add product filtering repository methods (Infrastructure layer - Optional optimization)
-   **Ticket #29**: Update AddActivityForm with cascading product selects (UI layer)

Please refer to the individual tickets for implementation details.

## Related Components

See individual sub-tickets for related components:

-   **Ticket #27**: `src/core/usecases/product.ts`
-   **Ticket #28**: `src/core/ports/productRepository.ts`, `src/infrastructure/supabase/productRepositorySupabase.ts`
-   **Ticket #29**: `src/presentation/components/addActivity/AddActivityForm/AddActivityForm.tsx`

## Dependencies

-   Ticket #14 (Add Activity page) - Must be completed first
-   Products must exist in database with correct structure (name, type, coloris)

## Notes

-   This is a UX improvement that makes product selection more intuitive
-   The current single-select approach works but becomes cumbersome with many products
-   Cascading dropdowns are a common pattern for hierarchical data selection
-   Auto-selection of unique coloris improves UX by reducing clicks
-   Stock management remains unchanged - each product (type + name + coloris) has its own stock

